# [Requests](https://www.django-rest-framework.org/api-guide/requests/#requests)

> 如果您正在做基于REST的Web服务...则应忽略request.POST。
>
> — [Django开发人员小组](https://groups.google.com/d/topic/django-developers/dxI4qVzrBY4/discussion) Malcom Tredinnick

REST框架的`Request`类扩展了标准`HttpRequest`，增加了对REST框架的灵活请求解析和请求身份验证的支持。

------

# [Request 解析](https://www.django-rest-framework.org/api-guide/requests/#request-parsing)

REST框架的Request对象提供了灵活的请求解析，使您能够以与通常处理表单数据相同的方式来处理JSON数据或其他媒体类型的请求。

## [.data](https://www.django-rest-framework.org/api-guide/requests/#data)

`request.data`返回请求正文的解析内容。这类似于标准`request.POST`和`request.FILES`属性，除了：

- 它包括所有已解析的内容，包括*文件和非文件*输入。
- 它支持解析除以外的HTTP方法的内容`POST`，这意味着您可以访问`PUT`和`PATCH`请求的内容。
- 它支持REST框架的灵活请求解析，而不仅仅是支持表单数据。例如，您可以以处理传入表单数据的相同方式处理传入JSON数据。

有关更多详细信息，请参见[解析器文档](https://www.django-rest-framework.org/api-guide/parsers/)。

## [.query_params](https://www.django-rest-framework.org/api-guide/requests/#query_params)

`request.query_params`是的更正确命名的同义词`request.GET`。

为了使代码内部更清晰，我们建议使用`request.query_params`，而不是Django的standard `request.GET`。这样做将有助于使您的代码库更加正确和明显-任何HTTP方法类型都可以包括查询参数，而不仅仅是`GET`请求。

## [.parsers](https://www.django-rest-framework.org/api-guide/requests/#parsers)

在`APIView`类或`@api_view`装饰将确保这个属性被自动设置为列表`Parser`实例的基础上，`parser_classes`对视图设置或基于该`DEFAULT_PARSER_CLASSES`设置。

您通常不需要访问此属性。

------

**注意：**如果客户端发送格式错误的内容，则访问`request.data`可能会引发`ParseError`。默认情况下，REST框架的`APIView`类或`@api_view`装饰器将捕获错误并返回`400 Bad Request`响应。

如果客户端发送的请求的内容类型无法解析，则将`UnsupportedMediaType`引发异常，默认情况下将捕获该异常并返回`415 Unsupported Media Type`响应。

------

# [内容协商](https://www.django-rest-framework.org/api-guide/requests/#content-negotiation)

该请求公开了一些属性，使您可以确定内容协商阶段的结果。这使您可以实现一些行为，例如为不同的媒体类型选择不同的序列化方案。

## [.accepted_renderer](https://www.django-rest-framework.org/api-guide/requests/#accepted_renderer)

内容协商阶段选择的渲染器实例。

## [.accepted_media_type](https://www.django-rest-framework.org/api-guide/requests/#accepted_media_type)

一个字符串，表示内容协商阶段接受的媒体类型。

------

# [认证方式](https://www.django-rest-framework.org/api-guide/requests/#authentication)

REST框架提供了灵活的按请求身份验证，使您能够：

- 对API的不同部分使用不同的身份验证策略。
- 支持使用多种身份验证策略。
- 提供与传入请求关联的用户和令牌信息。

## [.user](https://www.django-rest-framework.org/api-guide/requests/#user)

`request.user`通常会返回的实例`django.contrib.auth.models.User`，尽管其行为取决于所使用的身份验证策略。

如果请求未经身份验证，则默认值为`request.user`的实例`django.contrib.auth.models.AnonymousUser`。

有关更多详细信息，请参见[身份验证文档](https://www.django-rest-framework.org/api-guide/authentication/)。

## [.auth](https://www.django-rest-framework.org/api-guide/requests/#auth)

`request.auth`返回任何其他身份验证上下文。的确切行为`request.auth`取决于所使用的身份验证策略，但通常可能是身份验证请求所依据的令牌的实例。

如果该请求是未认证的，或者如果没有附加上下文存在时，默认值`request.auth`是`None`。

有关更多详细信息，请参见[身份验证文档](https://www.django-rest-framework.org/api-guide/authentication/)。

## [.authenticators](https://www.django-rest-framework.org/api-guide/requests/#authenticators)

在`APIView`类或`@api_view`装饰将确保这个属性被自动设置为列表`Authentication`实例的基础上，`authentication_classes`对视图设置或基于该`DEFAULT_AUTHENTICATORS`设置。

您通常不需要访问此属性。

------

**注意：**`WrappedAttributeError`调用`.user`或`.auth`属性时，您可能会看到一个凸起。这些错误源自作为标准的身份验证器`AttributeError`，但是有必要将它们重新引发为其他异常类型，以防止外部属性访问抑制它们。Python不会识别出`AttributeError`源于身份验证器，而是会假设请求对象没有`.user`或`.auth`属性。身份验证器将需要固定。

------

# [浏览器增强](https://www.django-rest-framework.org/api-guide/requests/#browser-enhancements)

REST框架支持的几个浏览器增强功能，例如基于浏览器的`PUT`，`PATCH`和`DELETE`形式。

## [.method](https://www.django-rest-framework.org/api-guide/requests/#method)

`request.method`返回请求的HTTP方法的**大写**字符串表示形式。

基于浏览器的`PUT`，`PATCH`而`DELETE`形式是透明的支持。

有关更多信息，请参阅[浏览器增强功能文档](https://www.django-rest-framework.org/topics/browser-enhancements/)。

## [.content_type](https://www.django-rest-framework.org/api-guide/requests/#content_type)

`request.content_type`，返回代表HTTP请求主体的媒体类型的字符串对象，如果未提供媒体类型，则返回空字符串。

通常，您通常不需要直接访问请求的内容类型，因为您通常将依赖于REST框架的默认请求解析行为。

如果确实需要访问请求的内容类型，则应`.content_type`优先使用属性而不是using `request.META.get('HTTP_CONTENT_TYPE')`，因为它为基于浏览器的非格式内容提供了透明的支持。

有关更多信息，请参阅[浏览器增强功能文档](https://www.django-rest-framework.org/topics/browser-enhancements/)。

## [.stream](https://www.django-rest-framework.org/api-guide/requests/#stream)

`request.stream` 返回表示请求正文内容的流。

通常，您通常不需要直接访问请求的内容，因为您通常会依赖REST框架的默认请求解析行为。

------

# [标准HttpRequest属性](https://www.django-rest-framework.org/api-guide/requests/#standard-httprequest-attributes)

随着REST框架对`Request`Django 的扩展`HttpRequest`，所有其他标准属性和方法也都可用。例如`request.META`和`request.session`字典可以正常使用。

请注意，由于实现原因，`Request`该类不继承自`HttpRequest`类，而是使用composition扩展了该类。